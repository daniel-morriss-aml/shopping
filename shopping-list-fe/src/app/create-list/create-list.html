<div class="min-h-screen bg-gray-50 py-8 px-4 flex">
    <div class="max-w-2xl mx-auto">
        <mat-card>
            <mat-card-header>
                <mat-card-title>Create New Shopping List</mat-card-title>
            </mat-card-header>

            <mat-card-content>
                @if (error()) {
                <div class="mb-4 p-4 bg-red-50 border border-red-200 rounded-md">
                    <p class="text-red-800">{{ error() }}</p>
                </div>
                }

                <form (ngSubmit)="onSubmit()" class="space-y-6">
                    <!-- List Name -->
                    <mat-form-field appearance="outline" style="width: 100%">
                        <mat-label>List Name</mat-label>
                        <input
                            matInput
                            [ngModel]="listName()"
                            (ngModelChange)="listName.set($event)"
                            name="listName"
                            placeholder="e.g., Weekly Shopping"
                            [disabled]="loading()"
                            required
                        />
                    </mat-form-field>

                    <!-- Share With Users -->
                    <div>
                        <h3 class="text-base font-medium mb-3">Share with Users</h3>
                        @if (loadingUsers()) {
                        <div class="flex justify-center p-4">
                            <mat-spinner diameter="40"></mat-spinner>
                        </div>
                        } @else {
                        <mat-list class="border border-gray-300 rounded max-h-60 overflow-y-auto">
                            @for (user of availableUsers(); track user.id) {
                            <mat-list-item>
                                <mat-checkbox
                                    [checked]="isUserSelected(user.id)"
                                    (change)="toggleUser(user.id)"
                                    [disabled]="loading()"
                                >
                                    <span class="font-medium">{{ user.name }}</span>
                                    <span class="text-sm text-gray-500 ml-2"
                                        >({{ user.email }})</span
                                    >
                                </mat-checkbox>
                            </mat-list-item>
                            }
                        </mat-list>
                        } @if (selectedUserIds().length > 0) {
                        <p class="mt-2 text-sm text-gray-600">
                            {{ selectedUserIds().length }} user(s) selected
                        </p>
                        }
                    </div>

                    <!-- Buttons -->
                    <div class="flex gap-4 pt-4">
                        <button
                            mat-raised-button
                            color="primary"
                            type="submit"
                            [disabled]="
                                loading() || !listName().trim() || selectedUserIds().length === 0
                            "
                            class="flex-1"
                        >
                            @if (loading()) {
                            <span>Creating...</span>
                            } @else {
                            <span>Create List</span>
                            }
                        </button>
                        <button
                            mat-raised-button
                            type="button"
                            (click)="cancel()"
                            [disabled]="loading()"
                            class="flex-1"
                        >
                            Cancel
                        </button>
                    </div>
                </form>
            </mat-card-content>
        </mat-card>
    </div>
</div>
